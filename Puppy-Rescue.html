<!DOCTYPE HTML>
<!--
	Das Spiel wurde von mir erstellt, ich besitze alle rechte daran.
-->
<html>
	<head>
		<title>Shadow Labs</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="author" content="David Hoerz">
		<link rel="stylesheet" href="assets/css/main.css" />
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.2/p5.js"></script>
	</head>
	<body class="subpage">

		<!-- Header -->
			<header id="header">
				<div class="inner">
					
					<nav id="nav">
						<a href="Main.html">Shadow Labs</a>
						<a href="Check.html">What is Shadow Labs?</a>
						<a href="Puppy-Rescue.html">Puppy-Rescue</a>
					</nav>
					<a href="#navPanel" class="navPanelToggle"><span class="fa fa-bars"></span></a>
				</div>
			</header>
			<!--Main Body-->
			<header class="align-center">
			<h2>My Game</h2>
			<p>Made by me.</p>
			</header>
			<article>
					<footer>
						<a href="Puppy-Rescue.html" class="button special">Reset</a>
          </footer>
			</article>
	</body>
	<script>
                                          //
var preload = function() {                //
  createCanvas(500, 500);                 //
}                                         //

var setup = function() {
points = 0;
keys = 0;
userName = "Shadow";
groundImage = loadImage("http://i.imgur.com/UJzXumI.png");
gemImage = loadImage("http://i.imgur.com/IKVQKid.png");
keyImage = loadImage("http://i.imgur.com/hcuJ5Wf.png");
doorImage = loadImage("http://i.imgur.com/HSABVYu.png");
wallsArray = [{
  
    xpos: 0,
    ypos: 0,
    width: 500,
    height: 20
  },
  {
    xpos: 0,
    ypos: 0,
    width: 20,
    height: 500
  },
  {
    xpos: 0,
    ypos: 480,
    width: 500,
    height: 20
  },
  {
    xpos: 480,
    ypos: 0,
    width: 20,
    height: 500
  },
  {
    xpos: 300,
    ypos: 150,
    width: 30,
    height: 240
  },
  {
    xpos: 100,
    ypos: 140,
    width: 380,
    height: 30
  },
  {
    xpos: 140,
    ypos: 150,
    width: 30,
    height: 240
  },
  {
    xpos: 220,
    ypos: 340,
    width: 100,
    height: 50,
  }
];

player = {
  xpos: 450,
  ypos: 175,
  width: 25,
  height: 50,
  img: loadImage("http://i.imgur.com/SKoYk7c.png"),
  startingPos: {
    x: 225,
    y: 225
  }
};

right = false;
left = false;
up = false;
down = false;

gemsArray = [{
    xpos: 380,
    ypos: 325,
    width: 50,
    height: 50,
    visible: true
  },
  {
    xpos: 30,
    ypos: 30,
    width: 50,
    height: 50,
    visible: true
  },
  {
    xpos: 200,
    ypos: 200,
    width: 50,
    height: 50,
    visible: true
  },
  {
    xpos: 390,
    ypos: 50,
    width: 50,
    height: 50,
    visible: true
  }
];

enemiesArray = [{
    xpos: 300,
    ypos: 400,
    width: 30,
    height: 20,
    spd: 2,
    dir: "y"
  },
  {
    xpos: 20,
    ypos: 140,
    width: 20,
    height: 30,
    spd: 3,
    dir: "x"
  },
  {
    xpos: 330,
    ypos: 325,
    width: 20,
    height: 65,
    spd: 3,
    dir: "x"
  },
  {
    xpos: 140,
    ypos: 400,
    width: 30,
    height: 20,
    spd: 2,
    dir: "y"
  }
];
keysArray = [{
    xpos: 445,
    ypos: 30,
    width: 25,
    height: 25,
    visible: true,
  }
];
doorsArray = [{
    xpos: 170,
    ypos: 340,
    width: 50,
    height: 50,
    img: doorImage,
    open: false
  }
];
}
                                          //
var jsonpls = function(url) {             //
  var req = new XMLHttpRequest();         //
  req.open("GET", url, false);            //
  req.send();                             //
                                          //
  if (req.status === 200) {               //
    return JSON.parse(req.responseText);  //
  } else {                                //
    return "memed";                       //
  }                                       //
}                                         //
                                          //
try {                                     //
    var RIGHT_ARROW = RIGHT;              //
    var LEFT_ARROW = LEFT;                //
    var UP_ARROW = UP;                    //
    var DOWN_ARROW = DOWN;                //
} catch (e) {}                            //
                                          //
var keyPressed = function() {             //
  if (keyCode == LEFT_ARROW) {            //
    left = true;                          //
  } else if (keyCode == RIGHT_ARROW) {    //
    right = true;                         //
  } else if (keyCode == UP_ARROW) {       //
    up = true;                            //
  } else if (keyCode == DOWN_ARROW) {     //
    down = true;                          //
  }                                       //
};                                        //
                                          //
var keyReleased = function() {            //
  if (keyCode == LEFT_ARROW) {            //
    left = false;                         //
  } else if (keyCode == RIGHT_ARROW) {    //
    right = false;                        //
  } else if (keyCode == UP_ARROW) {       //
    up = false;                           //
  } else if (keyCode == DOWN_ARROW) {     //
    down = false;                         //
  }                                       //
};                                        //
                                          //


//---------Variables---------\\

//---------------------------\\  


//--------Our Program--------\\

var draw = function() {
  noStroke();
  image(groundImage);
  
  drawDoors();
  drawKeys();
  drawWalls();
  drawText();
  drawGems();
  drawEnemies();
  moveEnemies();

  image(player.img,
    player.xpos,
    player.ypos,
    player.width,
    player.height);

  if (right === true) {
    player.xpos += 5;

    var n = 0;
    while (n < wallsArray.length) {
      while (collision(player, wallsArray[n])) {
        player.xpos -= 1;
      }
      n++;
    }
    
    
  }

  if (left === true) {
    player.xpos -= 5;
    var o = 0;
    while (o < wallsArray.length) {
      while (collision(player, wallsArray[o])) {
        player.xpos += 1;
      }
      o++;
    }
    
    
  }

  if (up === true) {
    player.ypos -= 5;
    var m = 0;
    while (m < wallsArray.length) {
      while (collision(player, wallsArray[m])) {
        player.ypos += 1;
      }
      m++;
    }
    
    var k = 0;
    while (k < doorsArray.length) {
      if (collision(player, doorsArray[k])) {
        if (keys && !doorsArray[k].open) {
          doorsArray[k].open = true;
          keys--;
        }
        if (!doorsArray[k].open) {
          while (collision(player, doorsArray[k])) {
            player.ypos += 1;
          }
        }
      }
      k++;
    }
  }

  if (down === true) {
    player.ypos += 5;
    var p = 0;
    while (p < wallsArray.length) {
      while (collision(player, wallsArray[p])) {
        player.ypos -= 1;
      }
      p++;
    }
    
    var k = 0;
    while (k < doorsArray.length) {
      if (collision(player, doorsArray[k])) {
        if (keys && !doorsArray[k].open) {
          doorsArray[k].open = true;
          keys--;
        }
        if (!doorsArray[k].open) {
          while (collision(player, doorsArray[k])) {
            player.ypos -= 1;
          }
        }
      }
      k++;
    }
  }
  
  var b = 0;
  while (b < enemiesArray.length) {
    if (collision(player, enemiesArray[b])) {
      resetPlayer();

    }
    b++;
  }


  if (player.xpos > 475) {
    player.xpos -= 5;
  }

  if (player.xpos < 0) {
    player.xpos += 5;
  }

  if (player.ypos > 455) {
    player.ypos -= 5;
  }

  if (player.ypos < 0) {
    player.ypos += 5;
  }

  drawText();
};

//---------------------------\\


//--------Functions-----------\\

var drawDoors = function() {
  for (let n = 0;n < doorsArray.length; n++) {
    if (!doorsArray[n].open) {
      image(doorImage,
            doorsArray[n].xpos,
            doorsArray[n].ypos,
            doorsArray[n].width,
            doorsArray[n].height);
    } else {
      image(doorImage,
            doorsArray[n].xpos,
            doorsArray[n].ypos,
            doorsArray[n].width/10,
            doorsArray[n].height);
    }
  }
};

var drawEnemies = function() {
  fill(255, 0, 0);
  for (var i = 0; i < enemiesArray.length; i++) {
    rect(enemiesArray[i].xpos,
      enemiesArray[i].ypos,
      enemiesArray[i].width,
      enemiesArray[i].height);


    if (enemiesArray[i].dir == "y") {
      enemiesArray[i].ypos += enemiesArray[i].spd;
    } else {
      enemiesArray[i].xpos += enemiesArray[i].spd;
    }

  }
};

var drawKeys = function() {
  var i = 0;
  while (i < keysArray.length) {
    if (keysArray[i].visible === true) {
      image(keyImage,
        keysArray[i].xpos,
        keysArray[i].ypos,
        keysArray[i].width,
        keysArray[i].height);
    }
    if (collision(player, keysArray[i]) && keysArray[i].visible) {
      keysArray[i].visible = false;
      keys +=1;
    }
    i++;
  }
};

var moveEnemies = function() {

  var j = 0;
  while (j < enemiesArray.length) {
    var i = 0;
    while (i < wallsArray.length) {
      if (collision(enemiesArray[j], wallsArray[i])) {
        enemiesArray[j].spd = enemiesArray[j].spd * -1;
        break;
      }
      i += 1;

    }

    j += 1;
  }
};

var resetPlayer = function() {
  player.xpos = 450;
  player.ypos = 175;

  for (var i = 0; i < gemsArray.length; i++) {
    gemsArray[i].visible = true;
  }

  points = 0;

  for (var i = 0; i < keysArray.length; i++) {
    keysArray[i].visible = true;
  }
  
  keys = 0;
  
  for (var i = 0; i < doorsArray.length; i++) {
    
  }
};

var collision = function(obj1, obj2) {
  if (obj1.xpos + obj1.width > obj2.xpos &&
    obj1.xpos < obj2.xpos + obj2.width &&
    obj1.ypos + obj1.height > obj2.ypos &&
    obj1.ypos < obj2.ypos + obj2.height) {
    return true;
  } else {
    return false;
  }
};

var drawWalls = function() {
  fill(244, 92, 66);

  for (let n = 0; n < wallsArray.length; n++) {
    rect(wallsArray[n].xpos,
      wallsArray[n].ypos,
      wallsArray[n].width,
      wallsArray[n].height);
  }
};

var drawGems = function() {
  var i = 0;
  while (i < gemsArray.length) {
    if (gemsArray[i].visible === true) {
      image(gemImage,
        gemsArray[i].xpos,
        gemsArray[i].ypos,
        gemsArray[i].width,
        gemsArray[i].height);
    }
    if (collision(player, gemsArray[i]) && gemsArray[i].visible) {
      gemsArray[i].visible = false;
      points += 1;
      if (points == 4) {
        alert("Du hast gewonnen, dein Preis ist das Passwort: ShadowLabs")
      }
    }
    i++;
  }
};

var drawText = function() {
  fill(255);
  textAlign(CENTER);
  textSize(12);
  text("(" + player.xpos + ", " + player.ypos + ")", 
       player.xpos + player.width / 2, player.ypos - 5);
  textAlign(LEFT);
  textSize(16);
  text("Puppies saved: " + points, 20, 479);
  text("keys: " + keys,20, 465);
  
};
  </script>
  <p onclick="document.write('ShadowLabs')"class="align-center">Falls igrendetwas schiefl√§uft und das Spiel nicht schaffbar ist oder das Passwort nicht erscheint einfach klicken.</p>

  
</html>